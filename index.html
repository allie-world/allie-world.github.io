<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>portfolio</title>
    
    <script>
        (function() {
            const path = window.location.pathname;
            if (path.endsWith('/index.html')) {
                const cleanpath = path.replace('/index.html', '');
                window.history.replaceState(null, '', cleanpath || '/');
            }
        })();
    </script>

    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/allie-world/allie-world.github.io/main/folder-icon.png">
    <script src="https://unpkg.com/interactjs/dist/interact.min.js"></script>
    <script src="https://www.midijs.net/lib/midi.js"></script>
    
    <style>
        :root { --bg-color: #fce4ec; --text-color: #000; --border: 1px solid #000; }
        
        html { background-color: var(--bg-color); height: -webkit-fill-available; }

        body { 
            margin: 0; padding: 0; width: 100%; height: 100vh;
            height: -webkit-fill-available; overflow: hidden; 
            background-color: var(--bg-color); position: fixed; 
            display: flex; flex-direction: column;
        }

        * { box-sizing: border-box; font-family: "Courier New", Courier, monospace; -webkit-tap-highlight-color: transparent; }

        .header-name { position: absolute; top: 20px; left: 20px; font-size: 14px; font-weight: bold; z-index: 100; pointer-events: none; }

        .desktop-container { flex: 1; width: 100%; position: relative; }

        .icon-wrapper { 
            position: absolute; width: 100px; display: flex; flex-direction: column; 
            align-items: center; cursor: grab; touch-action: none; user-select: none; 
            z-index: 10; visibility: hidden; 
        }

        .icon-wrapper.dragging a { pointer-events: none; }

        .icon-link { text-decoration: none; color: var(--text-color); display: flex; flex-direction: column; align-items: center; cursor: pointer; }
        .icon-img { width: 75px; height: auto; margin-bottom: 8px; -webkit-user-drag: none; }
        .icon-label { font-size: 11px; text-align: center; font-weight: bold; }

        /* UPDATED: Window styling for resizability */
        .window {
            position: absolute; 
            width: 320px; 
            height: auto; /* allows it to scale with content initially */
            min-width: 200px;
            min-height: 150px;
            background: var(--bg-color);
            border: var(--border); 
            display: none; 
            flex-direction: column;
            box-shadow: 4px 4px 0px #000; 
            z-index: 500; 
            touch-action: none;
        }

        .window-header {
            padding: 5px 10px; border-bottom: var(--border);
            display: flex; justify-content: space-between; align-items: center;
            cursor: grab; background: #fff;
        }

        .close-btn { cursor: pointer; font-weight: bold; border: var(--border); padding: 0 5px; background: #eee; }
        .close-btn:hover { background: #ddd; }

        /* Ensure content scrolls if window is small */
        .window-content { 
            padding: 15px; 
            overflow-y: auto; 
            flex-grow: 1; 
            font-size: 13px; 
            line-height: 1.5; 
        }

        .player-ui { text-align: center; }
        .now-playing { 
            background: #000; color: #fce4ec; padding: 5px; 
            margin-bottom: 15px; font-size: 10px; min-height: 25px;
            display: flex; align-items: center; justify-content: center;
        }
        .controls { display: flex; flex-direction: column; gap: 10px; }
        .track-selection { display: flex; justify-content: center; gap: 5px; }
        .playback-btns { display: flex; justify-content: center; gap: 5px; border-top: 1px dashed #000; padding-top: 10px; }
        
        .controls button { 
            cursor: pointer; border: var(--border); background: #fff;
            padding: 5px 10px; font-family: inherit; font-size: 11px;
            min-width: 45px;
        }
        #play-pause-btn { min-width: 80px; font-weight: bold; }

        .footer { 
            position: fixed; bottom: 0; left: 0; width: 100%; 
            height: calc(60px + env(safe-area-inset-bottom));
            padding-bottom: env(safe-area-inset-bottom);
            border-top: var(--border); display: flex; 
            justify-content: center; align-items: center; gap: 15px; 
            background-color: var(--bg-color); z-index: 100; 
        }

        .footer a, .footer span { text-decoration: none; color: #000; font-size: 12px; font-weight: bold; }
        .footer a:hover { text-decoration: underline; }

        #projects-icon { top: 10%; left: 5%; }
        #resume-icon   { top: 28%; left: 8%; }
        #linkedin-icon { top: 12%; left: 82%; }
        #about-icon    { top: 45%; left: 45%; }
        #contact-icon  { top: 60%; left: 80%; }
        #jams-icon     { top: 68%; left: 10%; }
    </style>
</head>
<body>

    <div class="header-name">allie swarr</div>

    <div class="desktop-container">
        <div id="projects-icon" class="icon-wrapper draggable">
            <a href="/projects" class="icon-link">
                <img src="https://raw.githubusercontent.com/allie-world/allie-world.github.io/main/6zfzzzry39ma1.gif" class="icon-img" alt="projects">
                <span class="icon-label">projects</span>
            </a>
        </div>

        <div id="resume-icon" class="icon-wrapper draggable">
            <a href="/resume" target="_blank" class="icon-link">
                <img src="https://raw.githubusercontent.com/allie-world/allie-world.github.io/main/book1.gif" class="icon-img" alt="resume">
                <span class="icon-label">resume</span>
            </a>
        </div>
        
        <div id="linkedin-icon" class="icon-wrapper draggable">
            <a href="https://www.linkedin.com/in/allie-swarr/" class="icon-link" target="_blank">
                <img src="https://raw.githubusercontent.com/allie-world/allie-world.github.io/main/mush.gif" class="icon-img" alt="linkedin">
                <span class="icon-label">LinkedIn</span>
            </a>
        </div>
        
        <div id="about-icon" class="icon-wrapper draggable">
            <div class="icon-link" onclick="openWindow('win-about')">
                <img src="https://raw.githubusercontent.com/allie-world/allie-world.github.io/main/runningunicorn.gif" class="icon-img" alt="about">
                <span class="icon-label">about me</span>
            </div>
        </div>

        <div id="contact-icon" class="icon-wrapper draggable">
            <a href="/contact" class="icon-link">
                <img src="https://raw.githubusercontent.com/allie-world/allie-world.github.io/main/email.gif" class="icon-img" alt="contact">
                <span class="icon-label">contact</span>
            </a>
        </div>

        <div id="jams-icon" class="icon-wrapper draggable">
            <div class="icon-link" onclick="openWindow('win-jams')">
                <img src="https://raw.githubusercontent.com/allie-world/allie-world.github.io/main/twirl.gif" class="icon-img" alt="jams">
                <span class="icon-label">jams</span>
            </div>
        </div>

        <div id="win-about" class="window resizable-window">
            <div class="window-header"><span>about_me.txt</span><div class="close-btn" onclick="closeWindow('win-about')">x</div></div>
            <div class="window-content">
                Hi! I'm Allie. <br><br>
                Iâ€™m a marketer based in NYC. Currently I lead social at Hudson River Trading, a quantitative trading firm, where I spend a lot of time thinking about how to nerd-snipe the smartest technologists with content that feels warm, smart, and human. On any given day, this might involve creative strategy, production, copywriting, design, and frequent Googling. (What are FLOPs, exactly?)
                <br><br>I like working on small teams who embrace tight deadlines and the challenge of getting the attention of people who are very good at ignoring marketing. <br><br>
                Want to chat more? Reach out to allie.swarr@gmail.com.
            </div>
        </div>

        <div id="win-jams" class="window resizable-window">
            <div class="window-header"><span>media_player.exe</span><div class="close-btn" onclick="closeWindow('win-jams')">x</div></div>
            <div class="window-content">
                <div class="player-ui">
                    <div class="now-playing">no track selected</div>
                    <div class="controls">
                        <div class="track-selection">
                            <button onclick="playMidi('onlytime.mid', 'only time')">01</button>
                            <button onclick="playMidi('Kingdom Hearts - Dearly Beloved.mid', 'dearly beloved')">02</button>
                            <button onclick="playMidi('Spirited Away - Inochi no Namae - The Name of Life.mid', 'spirited away')">03</button>
                        </div>
                        <div class="playback-btns">
                            <button id="play-pause-btn" onclick="togglePause()">play/pause</button>
                            <button onclick="stopMidi()">stop</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <a href="https://www.linkedin.com/in/allie-swarr" target="_blank">linkedin</a>
        <span>/</span>
        <a href="https://github.com/allie-world" target="_blank">github</a>
        <span>/</span>
        <a href="#" onclick="resetpositions(); return false;">reset</a>
    </footer>

    <script>
        let topZIndex = 500;
        let isPaused = false;
        let currentTrack = null;

        function openWindow(id) {
            const win = document.getElementById(id);
            win.style.display = 'flex';
            win.style.zIndex = ++topZIndex;
            if (!win.style.top && !win.getAttribute('data-x')) {
                win.style.top = '20%';
                win.style.left = '20%';
            }
        }

        function closeWindow(id) { document.getElementById(id).style.display = 'none'; }

        // MIDI Logic
        function playMidi(file, name) {
            MIDIjs.play(file);
            currentTrack = name;
            isPaused = false;
            document.querySelector('.now-playing').innerText = "now playing: " + name;
            document.querySelector('#play-pause-btn').innerText = "pause";
        }

        function togglePause() {
            if (!currentTrack) return;
            if (isPaused) {
                MIDIjs.resume();
                isPaused = false;
                document.querySelector('#play-pause-btn').innerText = "pause";
            } else {
                MIDIjs.pause();
                isPaused = true;
                document.querySelector('#play-pause-btn').innerText = "play";
            }
        }

        function stopMidi() {
            MIDIjs.stop();
            currentTrack = null;
            isPaused = false;
            document.querySelector('.now-playing').innerText = "stopped";
            document.querySelector('#play-pause-btn').innerText = "play/pause";
        }

        function saveposition(id, x, y) { localStorage.setItem(`pos_${id}`, JSON.stringify({x, y})); }

        function loadpositions() {
            document.querySelectorAll('.icon-wrapper').forEach(wrapper => {
                const saved = localStorage.getItem(`pos_${wrapper.id}`);
                if (saved) {
                    const {x, y} = JSON.parse(saved);
                    wrapper.style.transform = `translate(${x}px, ${y}px)`;
                    wrapper.setAttribute('data-x', x);
                    wrapper.setAttribute('data-y', y);
                }
                wrapper.style.visibility = 'visible';
            });
        }

        function resetpositions() {
            document.querySelectorAll('.icon-wrapper').forEach(wrapper => {
                localStorage.removeItem(`pos_${wrapper.id}`);
                wrapper.style.transform = 'none';
                wrapper.removeAttribute('data-x');
                wrapper.removeAttribute('data-y');
            });
        }

        // Draggable Icons
        interact('.draggable').draggable({
            inertia: true,
            listeners: {
                move (event) {
                    var target = event.target;
                    var x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
                    var y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;
                    target.style.transform = `translate(${x}px, ${y}px)`;
                    target.setAttribute('data-x', x);
                    target.setAttribute('data-y', y);
                },
                end (event) { 
                    saveposition(event.target.id, event.target.getAttribute('data-x'), event.target.getAttribute('data-y'));
                }
            }
        });

        // UPDATED: Combined Drag & Resize for Windows
        interact('.resizable-window')
        .draggable({
            allowFrom: '.window-header',
            listeners: {
                start(event) { event.target.style.zIndex = ++topZIndex; },
                move(event) {
                    const target = event.target;
                    const x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
                    const y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;
                    target.style.transform = `translate(${x}px, ${y}px)`;
                    target.setAttribute('data-x', x);
                    target.setAttribute('data-y', y);
                }
            }
        })
        .resizable({
            edges: { left: true, right: true, bottom: true, top: true },
            listeners: {
                move (event) {
                    var target = event.target;
                    var x = (parseFloat(target.getAttribute('data-x')) || 0);
                    var y = (parseFloat(target.getAttribute('data-y')) || 0);

                    target.style.width = event.rect.width + 'px';
                    target.style.height = event.rect.height + 'px';

                    x += event.deltaRect.left;
                    y += event.deltaRect.top;

                    target.style.transform = 'translate(' + x + 'px,' + y + 'px)';
                    target.setAttribute('data-x', x);
                    target.setAttribute('data-y', y);
                }
            },
            modifiers: [
                interact.modifiers.restrictEdges({ outer: 'parent' }),
                interact.modifiers.restrictSize({ min: { width: 200, height: 150 } })
            ],
            inertia: true
        });

        window.onload = loadpositions;
    </script>
</body>
</html>
